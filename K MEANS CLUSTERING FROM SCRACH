import random
import math

def euclid(a, b):
    return math.sqrt(sum((x - y) ** 2 for x, y in zip(a, b)))

def assign(points, centroids):
    clusters = [[] for _ in centroids]
    for p in points:
        idx = min(range(len(centroids)), key=lambda i: euclid(p, centroids[i]))
        clusters[idx].append(p)
    return clusters

def recompute(clusters):
    new_centroids = []
    for cluster in clusters:
        if not cluster:
            new_centroids.append([random.random() for _ in range(2)])
        else:
            dim = len(cluster[0])
            mean = [sum(p[d] for p in cluster) / len(cluster) for d in range(dim)]
            new_centroids.append(mean)
    return new_centroids

def kmeans(points, k, max_iter=100, tol=1e-4):
    centroids = random.sample(points, k)
    for _ in range(max_iter):
        clusters = assign(points, centroids)
        new_centroids = recompute(clusters)
        shift = sum(euclid(a, b) for a, b in zip(centroids, new_centroids))
        centroids = new_centroids
        if shift < tol:
            break
    return centroids, clusters

def demo():
    random.seed(42)
    points = [[random.uniform(0, 1), random.uniform(0, 1)] for _ in range(200)]
    cents, clusters = kmeans(points, 3)
    print("Centroids:", cents)
    print("Cluster sizes:", [len(c) for c in clusters])

if __name__ == "__main__":
    demo()
